unique_name: Test06232023
description: PnL metrics
icon_color_code: '#65EBF3'
icon_code: '7'
cover_photo_id: '12'
allowed_user_emails: rupam.basu@data-facade.com,darshan.rathi@data-facade.com,vishal.das@data-facade.com,subu@data-facade.com
editor_user_emails: rupam.basu@data-facade.com,darshan.rathi@data-facade.com,vishal.das@data-facade.com,subu@data-facade.com
table_config:
- table_name: Ixigo Clickhouse.fdwh_flight_booking_snapshot
  columns_to_ignore:
  - onward_ixi_booking_status_array
  - onward_airline_pnrs_array
  - onward_gds_pnrs_array
  - onward_ticket_numbers_array
  - payment_gateway_amount
  - collected_payment_gateway_amount
  - payment_transaction_ids_array
  - payment_amounts_array
  - payment_ids_array
  - ancillary_amount_array
  - ancillary_provider_array
  - ancillary_type_array
  - ingestion_time
  - offset
  - fare_type_details__fare_type_benefits__versions_array
  - fare_type_details__fare_type_benefits__refundable_array
  - fare_type_details__fare_type_benefits__benefit_provider_names_array
  - fare_type_details__fare_type_benefits__values_array
  - fare_type_details__fare_type_benefits__costs_array
  - adjustments__units_array
  - adjustments__type_array
  - adjustments__adjustment_id_array
  - adjustments__amount_array
  - adjustments__display_text_array
  - adjustments__offer_id_array
  - gst_detail__phone_sha256
  - gst_detail__email
  - gst_detail__email_lower_sha256
  - gst_detail__updated_on
  - billing_address__address1
  - billing_address__address2
  - itinerary_create_response__payment_response__gateway
  - provider_booking_data__all_provider_fares
  - provider_booking_data__cancellation_details
  - provider_booking_data__fare_details
  - itinerary_create_response__coupon_applied_msg
  - itinerary_create_response__convenience_fee
  - itinerary_create_response__ixigo_convenience_fee
  - itinerary_create_response__base_fare
  - itinerary_create_response__taxes
  - itinerary_create_response__order_id
  - itinerary_create_response__total_burn_amount
  - itinerary_create_response__payment_channel
  - itinerary_create_response__payment_type
  - itinerary_create_response__pg_type
  - itinerary_create_response__instant_discount
  - itinerary_create_response__cash_back_amount
  - itinerary_create_response__fare_change_message
  - ancilliary_data__airports__city_array
  - ancilliary_data__airports__country_array
  - itinerary_create_response__trip_id
  - itinerary_create_response__status_code
  - itinerary_create_response__current_fare
  - itinerary_create_response__changed_fare
  - itinerary_create_response__burn_amount
  - payment_detail_requests__payment_transaction_ids_array
  - payment_detail_requests__transaction_ids_array
  - payment_detail_requests__offer_ids_array
  - payment_detail_requests__capture_statuses_array
  - payment_detail_request__payment_status
  - payment_detail_request__payment_transaction_id
  - payment_detail_request__transaction_id
  - payment_detail_request__offer_id
  - payment_detail_request__payment_gateway_status
  - payment_detail_request__capture_status
  - payment_detail_requests__payment_types_array
  - contact_detail__email__lower_sha1
  - contact_detail__email__lower_sha256
  - contact_detail__mobile
  - contact_detail__mobile_sha1
  - contact_detail__mobile_sha256
  - payment_detail_request__payment_type
  - payment_detail_request__payment_amount
  - pax_pricing__booking__return_pax_statuses__updated_by_array
  - pax_pricing__booking__return_airline_pnr_history_array
  - pax_pricing__booking__return_reschedule_trip_id_array
  - return_segments_segment_pnrs_array
  - return_segments_durations_array
  - return_segments_checkin_luggage_array
  - return_segments_hand_luggage_array
  - return_segments_extra_charges_per_kg_array
  - return_segments_baggage_urls_array
  - return_segments_departure_terminals_array
  - return_segments_hand_baggage_only_array
  - return_segments_arrival_terminals_array
  - return_segments_booking_statuses_array
  - return_segments_booking_classes_array
  - return_segments_checkin_urls_array
  - return_segments_stops_array
  - return_segments_via_array
  - return_segments_scheduled_arrivals_array
  - return_segments_revised_scheduled_departures_array
  - return_segments_revised_scheduled_arrivals_array
  - return_segments_estimated_arrivals_array
  - return_segments_estimated_departures_array
  - return_segments_flight_status_codes_array
  - return_segments_internal_flight_status_codes_array
  - return_segments_arrive_timezones_array
  - return_segments_depart_airports_array
  - return_segments_arrive_airport_codes_array
  - return_segments_flight_numbers_array
  - return_segments_scheduled_departures_array
  - return_segments_airline_codes_array
  - return_segments_airline_names_array
  - return_segments_origin_cities_array
  - return_segments_destination_cities_array
  - return_segments_depart_timezones_array
  - pricing__ancillary_charges__ancillary_type_array
  - pricing__ancillary_charges__amount_array
  - pricing__ancillary_charges__provider_array
  - pricing__pending_insurance_amount
  - pricing__reschedule_adjustment
  - pricing__burn_amount
  - pricing__payment_gateway_amount
  - pricing__total_order_amount
  - pricing__collected_payment_gateway_amount
  - pricing__total_burn_amount
  - pricing__instant_discount
  - pricing__refund_amount
  - pricing__ixi_money_refund
  - pricing__currency
  - pricing__fare_breakup__keys_array
  - pricing__fare_breakup__values__amounts_array
  - pricing__fare_breakup__values__ranks_array
  - pricing__base_fare
  - pricing__ixi_markup
  - pricing__markup
  - pricing__discount
  - ancilliary_data__airlines__airline_name_array
  - ancilliary_data__airports__name_array
  - pricing__ancillary_charges__amount_breakup_array
  - pax_pricing__booking__onward_cancellation_request_ids_array
  - pax_pricing__booking__onward_ixigo_cancellation_ids_array
  - pax_pricing__booking__onward_pax_statuses__flight_booking_status_array
  - pax_pricing__booking__onward_pax_statuses__time_array
  - pax_pricing__booking__onward_cabin_type_array
  - pax_pricing__booking__onward_pax_statuses__updated_by_array
  - pax_pricing__booking__onward_airline_pnr_history_array
  - pax_pricing__booking__onward_ticket_type_array
  - pax_pricing__booking__onward_ixi_booking_status_array
  - pax_pricing__booking__onward_booking_status_array
  - pax_pricing__booking__onward_airline_pnrs_array
  - pax_pricing__fare_keys_array
  - pax_date_of_birth_array
- table_name: Ixigo Clickhouse.flight_search
  columns_to_ignore:
  - os_version
  - device_os
  - app_version
- table_name: Ixigo Clickhouse.fdwh_freeCancellationPolicy_snapshot
- table_name: Ixigo Clickhouse.fdwh_freeReschedulePolicy_snapshot
- table_name: Ixigo Clickhouse.etl_flight_flex_booking_snapshot
default_chat_context: "1.  Don't use \"ingestion_time\" and don't assume any additional\
  \ filters\n2. Add \"FINAL\" keyword after the table name or alias if table name\
  \ ends with  \"_snapshot\". i.e. \"SELECT * From db.etl_flight_flex_booking_snapshot\
  \ as t_alias FINAL\". No additional keywords. \n3. Always add conditions containing\
  \ toDate() at the beginning before others in WHERE clause to optimize query performance.\n\
  4. If you are joining any two tables use GLOBAL JOIN.\n5. This is run on distributed\
  \ clickhouse database. You must optimize the query for better performance. \n6.\
  \ Always use table alias while selecting a table i.e. \"Select a from table t1 FINAL\"\
  \ \n7.  Use the columns which are provided. Don't make up column names. \n8. Allowed\
  \ booking_status values are 'BOOKING_COMPLETE', 'REFUNDED', 'CANCELLED', 'TO_BE_CANCELLED',\
  \ 'CANCELLED_PROVIDER_CANCELLATION_PENDING', 'REFUNDED_PROVIDER_CANCELLATION_PENDING',\
  \ 'RESCHEDULED', 'TO_BE_RESCHEDULED'\n9. Use `arrayElement(onward_segments_scheduled_departures_array,1)`\
  \ to calculate departure timestamp\n10. The datetime columns are in GMT. Convert\
  \ it to 'Asia/Kolkata' timezone before generating any result.\n11. Always filter\
  \ the tables first if required before performing any join operations.\n12. Use toFloat32OrZero()\
  \ to cast to Float\n13. Use the CAST function to convert the date into text for\
  \ displaying the output. For example: toDate(toDateTime(\"created_at\", 'Asia/Kolkata'))\
  \ AS \"booking_date\" needs to be changed to CAST(toDate(toDateTime(\"created_at\"\
  , 'Asia/Kolkata'), TEXT) AS \"booking_date\""
chat_contexts:
- keywords:
  - apd_search
  table_config:
  - table_name: Ixigo Clickhouse.flight_search
    columns_to_ignore:
    - search_primary_id
    - product
    - cabin_class
    - timestamp
    - wallet_balance
    - num_of_adult
    - destination_code
    - destination_country
    - ip
    - os_version
    - device_os
    - client_id
    - app_version
    - origin_city
    - origin_code
    - finger_print
    - device_id
    - latitude
    - longitude
    - arrival_date
    - provider_ids
    - ingestion_time
    - partition_column
    - num_of_children
    - origin_state
    - num_of_infants
    - origin_country
    - destination_city
    - destination_state
  behaviour: "APD_search = (timestamp_datetime - departure_date) in days calculated\
    \ from the 'flight_search' table.\nUse DATEDIFF function to calculate the difference.\
    \ \nThe timestamp_datetime, departure_date columns are in GMT. Convert them to\
    \ 'Asia/Kolkata' timezone before generating any result. \nReturn APD counts for\
    \ the following buckets: 0-2 days, 3 - 7 days, 8 - 15 days, 16 - 30 days, 31 -\
    \ 60 days, 61 - 90 days, 90 + days."
- keywords:
  - apd_transactions
  table_config:
  - table_name: Ixigo Clickhouse.fdwh_flight_booking_snapshot
    columns_to_ignore:
    - id
    - changed_fare
    - fare_basis_codes_array
    - onward_ixi_booking_status_array
    - onward_airline_pnrs_array
    - onward_gds_pnrs_array
    - onward_ticket_numbers_array
    - payment_gateway_amount
    - collected_payment_gateway_amount
    - payment_transaction_ids_array
    - payment_amounts_array
    - payment_ids_array
    - taxes
    - total_fare
    - fees
    - convenience_fee
    - burn_amount
    - discount
    - instant_discount
    - refundable
    - ancillary_amount_array
    - ancillary_provider_array
    - ancillary_type_array
    - currency
    - preferred_currency
    - base_fare
    - free_reschedule_transaction_ids
    - availing_free_reschedule
    - ingestion_time
    - offset
    - cabin_class
    - fare_key
    - inventory_type
    - flow_type_enum
    - insurance_provider
    - insurance_token
    - reschedule_trip_ids
    - flex_child_booking
    - reschedule_tracker_id
    - fare_type_details__fare_type_benefits__versions_array
    - fare_type_details__fare_type_benefits__refundable_array
    - fare_type_details__fare_type_benefits__benefit_provider_names_array
    - source
    - adjustments__type_array
    - adjustments__units_array
    - partner_user_id
    - fare_type_details__fare_type_benefits__values_array
    - fare_type_details__fare_type_benefits__costs_array
    - invoice_url
    - invoice_id
    - updated_at
    - adjustments__adjustment_id_array
    - adjustments__amount_array
    - adjustments__display_text_array
    - adjustments__offer_id_array
    - availing_free_cancellation
    - native_cancellation
    - allow_reschedule
    - allow_cancellation
    - eticket_url
    - billing_address__city
    - billing_address__state
    - billing_address__pincode
    - billing_address__country
    - app_version
    - payment_transaction_id
    - free_cancellation_transaction_ids
    - gst_detail__phone_sha256
    - gst_detail__email
    - gst_detail__email_lower_sha256
    - gst_detail__updated_on
    - billing_address__address1
    - billing_address__address2
    - gst_detail__name
    - gst_detail__address
    - gst_detail__pin
    - gst_detail__state
    - gst_detail__phone
    - gst_detail__phone_sha1
    - instant_discount_applied
    - device_id
    - status_history_values
    - gst_detail__id
    - provider_booking_data__fare_details
    - provider_booking_data__cancellation_details
    - provider_booking_data__all_provider_fares
    - price_change_absorbed
    - order_id
    - coupon_code
    - itinerary_create_response__payment_response__gateway
    - international
    - international_for_ota
    - coupon_generated
    - user_source
    - provider_booking_data__search_id
    - itinerary_create_response__coupon_applied_msg
    - itinerary_create_response__convenience_fee
    - itinerary_create_response__ixigo_convenience_fee
    - itinerary_create_response__base_fare
    - itinerary_create_response__taxes
    - itinerary_create_response__total_burn_amount
    - itinerary_create_response__order_id
    - itinerary_create_response__payment_channel
    - itinerary_create_response__payment_type
    - itinerary_create_response__pg_type
    - itinerary_create_response__instant_discount
    - itinerary_create_response__cash_back_amount
    - itinerary_create_response__fare_change_message
    - ancilliary_data__airports__city_array
    - ancilliary_data__airports__country_array
    - itinerary_create_response__trip_id
    - itinerary_create_response__status_code
    - itinerary_create_response__current_fare
    - itinerary_create_response__changed_fare
    - itinerary_create_response__burn_amount
    - fare_rules_titles_array
    - fare_rules_texts_array
    - ancilliary_data__airlines__airline_code_array
    - payment_detail_requests__payment_transaction_ids_array
    - payment_detail_requests__transaction_ids_array
    - payment_detail_requests__offer_ids_array
    - payment_detail_requests__capture_statuses_array
    - payment_detail_request__payment_status
    - payment_detail_request__payment_transaction_id
    - payment_detail_request__transaction_id
    - payment_detail_request__offer_id
    - payment_detail_request__capture_status
    - payment_detail_request__payment_gateway_status
    - payment_detail_requests__payment_types_array
    - contact_detail__email__lower_sha1
    - contact_detail__email__lower_sha256
    - contact_detail__mobile
    - contact_detail__mobile_sha1
    - contact_detail__mobile_sha256
    - payment_detail_request__payment_type
    - payment_detail_request__payment_amount
    - pax_pricing__booking__return_pax_statuses__updated_by_array
    - pax_pricing__booking__return_airline_pnr_history_array
    - pax_pricing__booking__return_reschedule_trip_id_array
    - contact_detail__title
    - contact_detail__first_name
    - contact_detail__last_name
    - contact_detail__email
    - pax_pricing__booking__return_gds_pnrs_array
    - pax_pricing__booking__return_ticket_numbers_array
    - pax_pricing__booking__return_airline_ticket_numbers_array
    - pax_pricing__booking__return_cancellation_request_ids_array
    - pax_pricing__booking__return_ixigo_cancellation_ids_array
    - pax_pricing__booking__return_pax_statuses__flight_booking_status_array
    - pax_pricing__booking__return_pax_statuses__time_array
    - pax_pricing__booking__onward_reschedule_trip_id_array
    - pax_pricing__booking__return_booking_class_array
    - pax_pricing__booking__return_booking_status_array
    - pax_pricing__booking__return_ixi_booking_status_array
    - pax_pricing__booking__return_airline_pnrs_array
    - pax_pricing__booking__onward_gds_pnrs_array
    - pax_pricing__booking__onward_ticket_numbers_array
    - pax_pricing__fare_basis_codes_array
    - pax_pricing__fare_types_array
    - pax_pricing__pricing_elements_array
    - pax_pricing__booking_info_ids_array
    - pax_pricing__ixigo_forward_ids_array
    - pax_nationalities_array
    - pax_birth_country_array
    - pax_visa_type_array
    - pax_frequent_flier_number__airlines_array
    - pax_frequent_flier_number__number_array
    - pax_frequent_flier_number__applicable_airlines_array
    - pax_person_id_array
    - pax_id_number_array
    - pax_passport_number_array
    - pax_passport_issue_date_array
    - pax_passport_expiry_date_array
    - pax_passport_issuing_country_array
    - pax_indexes_array
    - pax_titles_array
    - pax_first_names_array
    - pax_last_names_array
    - pax_types_array
    - search_request__num_children
    - search_request__num_infants
    - search_request__origin
    - search_request__destination
    - search_request__is_international
    - return_segments_segment_pnrs_array
    - return_segments_durations_array
    - return_segments_checkin_luggage_array
    - return_segments_hand_luggage_array
    - return_segments_extra_charges_per_kg_array
    - return_segments_baggage_urls_array
    - return_segments_hand_baggage_only_array
    - return_segments_departure_terminals_array
    - return_segments_arrival_terminals_array
    - return_segments_booking_statuses_array
    - return_segments_booking_classes_array
    - return_segments_checkin_urls_array
    - return_segments_stops_array
    - return_segments_via_array
    - return_segments_scheduled_arrivals_array
    - return_segments_revised_scheduled_departures_array
    - return_segments_revised_scheduled_arrivals_array
    - return_segments_estimated_departures_array
    - return_segments_estimated_arrivals_array
    - return_segments_flight_status_codes_array
    - return_segments_internal_flight_status_codes_array
    - return_segments_arrive_timezones_array
    - return_segments_depart_airports_array
    - return_segments_arrive_airport_codes_array
    - return_segments_flight_numbers_array
    - return_segments_scheduled_departures_array
    - return_segments_airline_codes_array
    - return_segments_airline_names_array
    - return_segments_origin_cities_array
    - return_segments_destination_cities_array
    - return_segments_depart_timezones_array
    - onward_segments_via_array
    - onward_segments_segment_pnrs_array
    - onward_segments_durations_array
    - onward_segments_checkin_luggage_array
    - onward_segments_hand_luggage_array
    - onward_segments_extra_charges_per_kg_array
    - onward_segments_baggage_urls_array
    - onward_segments_internal_flight_status_codes_array
    - onward_segments_departure_terminals_array
    - onward_segments_arrival_terminals_array
    - onward_segments_booking_statuses_array
    - onward_segments_booking_classes_array
    - onward_segments_checkin_urls_array
    - onward_segments_stops_array
    - onward_segments_revised_scheduled_departures_array
    - onward_segments_revised_scheduled_arrivals_array
    - onward_segments_estimated_departures_array
    - onward_segments_estimated_arrivals_array
    - onward_segments_flight_status_codes_array
    - onward_segments_depart_timezones_array
    - onward_segments_arrive_timezones_array
    - onward_segments_depart_airports_array
    - onward_segments_depart_airport_codes_array
    - onward_segments_arrive_airports_array
    - onward_segments_arrive_airport_codes_array
    - onward_segments_flight_numbers_array
    - cabin_type
    - segment_count
    - onward_segments_count
    - onward_segments_origin_cities_array
    - pricing__ancillary_charges__ancillary_type_array
    - pricing__ancillary_charges__amount_array
    - pricing__ancillary_charges__provider_array
    - pricing__pending_insurance_amount
    - pricing__reschedule_adjustment
    - pricing__burn_amount
    - pricing__payment_gateway_amount
    - pricing__total_order_amount
    - pricing__collected_payment_gateway_amount
    - pricing__total_burn_amount
    - pricing__instant_discount
    - pricing__convenience_fee
    - pricing__refund_amount
    - pricing__ixi_money_refund
    - pricing__currency
    - pricing__fare_breakup__keys_array
    - pricing__fare_breakup__values__amounts_array
    - pricing__fare_breakup__values__ranks_array
    - pricing__base_fare
    - pricing__markup
    - pricing__ixi_markup
    - pricing__discount
    - fare_type_details__fare_type
    - gst_detail__email_lower_sha1
    - gst_detail__city
    - gst_detail__user_id
    - provider_booking_data__rw_search_id
    - payment_detail_requests__reference_ids_array
    - pricing__fees
    - pricing__taxes
    - pricing__total_fare
    - round_trip
    - onward_pnr
    - return_pnr
    - partner_booking_id_array
    - offered_fare
    - published_fare
    - extra_publish_fare_scraper
    - search_primary_id
    - origin
    - destination
    - onward_departure_date
    - return_departure_date
    - provider_id
    - ancilliary_data__airlines__airline_name_array
    - ancilliary_data__airports__name_array
    - payment_detail_requests__payment_statuses_array
    - payment_detail_requests__payment_gateway_statuses_array
    - pax_pricing__booking__return_cabin_type_array
    - pax_pricing__booking__onward_airline_ticket_numbers_array
    - pax_pricing__booking__onward_booking_class_array
    - pax_pricing__pax_type_array
    - search_request__search_id
    - search_request__fare_key
    - search_request__num_adults
    - return_segments_depart_airport_codes_array
    - onward_segments_hand_baggage_only_array
    - onward_segments_scheduled_arrivals_array
    - onward_segments_airline_codes_array
    - onward_segments_destination_cities_array
    - pricing__ancillary_charges__amount_breakup_array
    - pricing__preferred_currency
    - ixi_src_header
    - client_id
    - adjustments_amount_array
    - adjustments_display_text_array
    - adjustments_offer_id_array
    - adjustments_type_array
    - onward_ixigo_cancellation_ids_array
    - onward_cancellation_request_ids_array
    - return_ixi_booking_status_array
    - return_airline_pnrs_array
    - return_gds_pnrs_array
    - return_ticket_numbers_array
    - return_airline_ticket_numbers_array
    - gstin
    - refund_blocked
    - itinerary_create_response__ancillary_charges__ancillary_type__array
    - itinerary_create_response__ixi_markup
    - return_segments_count
    - trip_id
    - user_id
    - itinerary_id
    - pnr_list
    - onward_segments_origins_array
    - onward_segments_destinations_array
    - return_segments_origins_array
    - return_segments_destinations_array
    - partition_column
    - adjustments_units_array
    - fare_type
    - fare_type_benefits_names_array
    - fare_type_benefits_values_array
    - original_fare
    - child_trip_id
    - refunded
    - status_history_timestamps
    - payment_detail_requests__payment_amounts_array
    - pax_pricing__booking__onward_cancellation_request_ids_array
    - pax_pricing__booking__onward_ixigo_cancellation_ids_array
    - pax_pricing__booking__onward_pax_statuses__flight_booking_status_array
    - pax_pricing__booking__onward_pax_statuses__time_array
    - pax_pricing__booking__onward_pax_statuses__updated_by_array
    - pax_pricing__booking__onward_airline_pnr_history_array
    - pax_pricing__booking__onward_cabin_type_array
    - pax_pricing__booking__onward_ticket_type_array
    - pax_pricing__booking__onward_booking_status_array
    - pax_pricing__booking__onward_ixi_booking_status_array
    - pax_pricing__booking__onward_airline_pnrs_array
    - pax_pricing__fare_keys_array
    - pax_date_of_birth_array
    - return_segments_arrive_airports_array
    - onward_segments_airline_names_array
    - fare_type_benefits_costs_array
    - onward_airline_ticket_numbers_array
    - parent_trip_id
    - return_ixigo_cancellation_ids_array
    - return_cancellation_request_ids_array
    - adjustments_adjustment_id_array
    - total_order_amount
    - fare_type_details__fare_type_benefits__names_array
    - gst_detail__gstin
    - ancilliary_data__airports__code_array
    - pax_pricing__booking__return_ticket_type_array
    - pax_count
    - pricing__refundable
    - reschedule_sub_type
    - total_burn_amount
  behaviour: "APD_transactions = (created_at - arrayElement(onwards_segments_scheduled_departures_array,1))\
    \ in days from the 'fdwh_flight_booking_snapshot'\nUse DATEDIFF function to calculate\
    \ the difference. \nThe created_at, arrayElement(onwards_segments_scheduled_departures_array,1)\
    \ columns are in GMT. Convert all of them to 'Asia/Kolkata' timezone before generating\
    \ any result. \nReturn APD counts for the following buckets: 0-2 days, 3 - 7 days,\
    \ 8 - 15 days, 16 - 30 days, 31 - 60 days, 61 - 90 days, 90 + days."
- keywords:
  - apd_conversion_rate
  table_config:
  - table_name: Ixigo Clickhouse.fdwh_flight_booking_snapshot
    columns_to_ignore:
    - id
    - changed_fare
    - fare_basis_codes_array
    - onward_ixi_booking_status_array
    - onward_airline_pnrs_array
    - onward_gds_pnrs_array
    - onward_ticket_numbers_array
    - payment_gateway_amount
    - collected_payment_gateway_amount
    - payment_transaction_ids_array
    - payment_amounts_array
    - payment_ids_array
    - taxes
    - total_fare
    - fees
    - convenience_fee
    - burn_amount
    - discount
    - instant_discount
    - refundable
    - ancillary_amount_array
    - ancillary_provider_array
    - ancillary_type_array
    - currency
    - preferred_currency
    - base_fare
    - free_reschedule_transaction_ids
    - availing_free_reschedule
    - ingestion_time
    - offset
    - cabin_class
    - fare_key
    - inventory_type
    - flow_type_enum
    - insurance_provider
    - insurance_token
    - reschedule_trip_ids
    - flex_child_booking
    - reschedule_tracker_id
    - fare_type_details__fare_type_benefits__versions_array
    - fare_type_details__fare_type_benefits__refundable_array
    - fare_type_details__fare_type_benefits__benefit_provider_names_array
    - source
    - adjustments__type_array
    - adjustments__units_array
    - partner_user_id
    - fare_type_details__fare_type_benefits__values_array
    - fare_type_details__fare_type_benefits__costs_array
    - invoice_url
    - invoice_id
    - updated_at
    - adjustments__adjustment_id_array
    - adjustments__amount_array
    - adjustments__display_text_array
    - adjustments__offer_id_array
    - availing_free_cancellation
    - native_cancellation
    - allow_reschedule
    - allow_cancellation
    - eticket_url
    - billing_address__city
    - billing_address__state
    - billing_address__pincode
    - billing_address__country
    - app_version
    - payment_transaction_id
    - free_cancellation_transaction_ids
    - gst_detail__phone_sha256
    - gst_detail__email
    - gst_detail__email_lower_sha256
    - gst_detail__updated_on
    - billing_address__address1
    - billing_address__address2
    - gst_detail__name
    - gst_detail__address
    - gst_detail__pin
    - gst_detail__state
    - gst_detail__phone
    - gst_detail__phone_sha1
    - instant_discount_applied
    - device_id
    - status_history_values
    - gst_detail__id
    - provider_booking_data__fare_details
    - provider_booking_data__cancellation_details
    - provider_booking_data__all_provider_fares
    - price_change_absorbed
    - order_id
    - coupon_code
    - itinerary_create_response__payment_response__gateway
    - international
    - international_for_ota
    - coupon_generated
    - user_source
    - provider_booking_data__search_id
    - itinerary_create_response__coupon_applied_msg
    - itinerary_create_response__convenience_fee
    - itinerary_create_response__ixigo_convenience_fee
    - itinerary_create_response__base_fare
    - itinerary_create_response__taxes
    - itinerary_create_response__total_burn_amount
    - itinerary_create_response__order_id
    - itinerary_create_response__payment_channel
    - itinerary_create_response__payment_type
    - itinerary_create_response__pg_type
    - itinerary_create_response__instant_discount
    - itinerary_create_response__cash_back_amount
    - itinerary_create_response__fare_change_message
    - ancilliary_data__airports__city_array
    - ancilliary_data__airports__country_array
    - itinerary_create_response__trip_id
    - itinerary_create_response__status_code
    - itinerary_create_response__current_fare
    - itinerary_create_response__changed_fare
    - itinerary_create_response__burn_amount
    - fare_rules_titles_array
    - fare_rules_texts_array
    - ancilliary_data__airlines__airline_code_array
    - payment_detail_requests__payment_transaction_ids_array
    - payment_detail_requests__transaction_ids_array
    - payment_detail_requests__offer_ids_array
    - payment_detail_requests__capture_statuses_array
    - payment_detail_request__payment_status
    - payment_detail_request__payment_transaction_id
    - payment_detail_request__transaction_id
    - payment_detail_request__offer_id
    - payment_detail_request__capture_status
    - payment_detail_request__payment_gateway_status
    - payment_detail_requests__payment_types_array
    - contact_detail__email__lower_sha1
    - contact_detail__email__lower_sha256
    - contact_detail__mobile
    - contact_detail__mobile_sha1
    - contact_detail__mobile_sha256
    - payment_detail_request__payment_type
    - payment_detail_request__payment_amount
    - pax_pricing__booking__return_pax_statuses__updated_by_array
    - pax_pricing__booking__return_airline_pnr_history_array
    - pax_pricing__booking__return_reschedule_trip_id_array
    - contact_detail__title
    - contact_detail__first_name
    - contact_detail__last_name
    - contact_detail__email
    - pax_pricing__booking__return_gds_pnrs_array
    - pax_pricing__booking__return_ticket_numbers_array
    - pax_pricing__booking__return_airline_ticket_numbers_array
    - pax_pricing__booking__return_cancellation_request_ids_array
    - pax_pricing__booking__return_ixigo_cancellation_ids_array
    - pax_pricing__booking__return_pax_statuses__flight_booking_status_array
    - pax_pricing__booking__return_pax_statuses__time_array
    - pax_pricing__booking__onward_reschedule_trip_id_array
    - pax_pricing__booking__return_booking_class_array
    - pax_pricing__booking__return_booking_status_array
    - pax_pricing__booking__return_ixi_booking_status_array
    - pax_pricing__booking__return_airline_pnrs_array
    - pax_pricing__booking__onward_gds_pnrs_array
    - pax_pricing__booking__onward_ticket_numbers_array
    - pax_pricing__fare_basis_codes_array
    - pax_pricing__fare_types_array
    - pax_pricing__pricing_elements_array
    - pax_pricing__booking_info_ids_array
    - pax_pricing__ixigo_forward_ids_array
    - pax_nationalities_array
    - pax_birth_country_array
    - pax_visa_type_array
    - pax_frequent_flier_number__airlines_array
    - pax_frequent_flier_number__number_array
    - pax_frequent_flier_number__applicable_airlines_array
    - pax_person_id_array
    - pax_id_number_array
    - pax_passport_number_array
    - pax_passport_issue_date_array
    - pax_passport_expiry_date_array
    - pax_passport_issuing_country_array
    - pax_indexes_array
    - pax_titles_array
    - pax_first_names_array
    - pax_last_names_array
    - pax_types_array
    - search_request__num_children
    - search_request__num_infants
    - search_request__origin
    - search_request__destination
    - search_request__is_international
    - return_segments_segment_pnrs_array
    - return_segments_durations_array
    - return_segments_checkin_luggage_array
    - return_segments_hand_luggage_array
    - return_segments_extra_charges_per_kg_array
    - return_segments_baggage_urls_array
    - return_segments_hand_baggage_only_array
    - return_segments_departure_terminals_array
    - return_segments_arrival_terminals_array
    - return_segments_booking_statuses_array
    - return_segments_booking_classes_array
    - return_segments_checkin_urls_array
    - return_segments_stops_array
    - return_segments_via_array
    - return_segments_scheduled_arrivals_array
    - return_segments_revised_scheduled_departures_array
    - return_segments_revised_scheduled_arrivals_array
    - return_segments_estimated_departures_array
    - return_segments_estimated_arrivals_array
    - return_segments_flight_status_codes_array
    - return_segments_internal_flight_status_codes_array
    - return_segments_arrive_timezones_array
    - return_segments_depart_airports_array
    - return_segments_arrive_airport_codes_array
    - return_segments_flight_numbers_array
    - return_segments_scheduled_departures_array
    - return_segments_airline_codes_array
    - return_segments_airline_names_array
    - return_segments_origin_cities_array
    - return_segments_destination_cities_array
    - return_segments_depart_timezones_array
    - onward_segments_via_array
    - onward_segments_segment_pnrs_array
    - onward_segments_durations_array
    - onward_segments_checkin_luggage_array
    - onward_segments_hand_luggage_array
    - onward_segments_extra_charges_per_kg_array
    - onward_segments_baggage_urls_array
    - onward_segments_internal_flight_status_codes_array
    - onward_segments_departure_terminals_array
    - onward_segments_arrival_terminals_array
    - onward_segments_booking_statuses_array
    - onward_segments_booking_classes_array
    - onward_segments_checkin_urls_array
    - onward_segments_stops_array
    - onward_segments_revised_scheduled_departures_array
    - onward_segments_revised_scheduled_arrivals_array
    - onward_segments_estimated_departures_array
    - onward_segments_estimated_arrivals_array
    - onward_segments_flight_status_codes_array
    - onward_segments_depart_timezones_array
    - onward_segments_arrive_timezones_array
    - onward_segments_depart_airports_array
    - onward_segments_depart_airport_codes_array
    - onward_segments_arrive_airports_array
    - onward_segments_arrive_airport_codes_array
    - onward_segments_flight_numbers_array
    - cabin_type
    - segment_count
    - onward_segments_count
    - onward_segments_origin_cities_array
    - pricing__ancillary_charges__ancillary_type_array
    - pricing__ancillary_charges__amount_array
    - pricing__ancillary_charges__provider_array
    - pricing__pending_insurance_amount
    - pricing__reschedule_adjustment
    - pricing__burn_amount
    - pricing__payment_gateway_amount
    - pricing__total_order_amount
    - pricing__collected_payment_gateway_amount
    - pricing__total_burn_amount
    - pricing__instant_discount
    - pricing__convenience_fee
    - pricing__refund_amount
    - pricing__ixi_money_refund
    - pricing__currency
    - pricing__fare_breakup__keys_array
    - pricing__fare_breakup__values__amounts_array
    - pricing__fare_breakup__values__ranks_array
    - pricing__base_fare
    - pricing__markup
    - pricing__ixi_markup
    - pricing__discount
    - fare_type_details__fare_type
    - gst_detail__email_lower_sha1
    - gst_detail__city
    - gst_detail__user_id
    - provider_booking_data__rw_search_id
    - payment_detail_requests__reference_ids_array
    - pricing__fees
    - pricing__taxes
    - pricing__total_fare
    - round_trip
    - onward_pnr
    - return_pnr
    - partner_booking_id_array
    - offered_fare
    - published_fare
    - extra_publish_fare_scraper
    - search_primary_id
    - origin
    - destination
    - onward_departure_date
    - return_departure_date
    - provider_id
    - ancilliary_data__airlines__airline_name_array
    - ancilliary_data__airports__name_array
    - payment_detail_requests__payment_statuses_array
    - payment_detail_requests__payment_gateway_statuses_array
    - pax_pricing__booking__return_cabin_type_array
    - pax_pricing__booking__onward_airline_ticket_numbers_array
    - pax_pricing__booking__onward_booking_class_array
    - pax_pricing__pax_type_array
    - search_request__search_id
    - search_request__fare_key
    - search_request__num_adults
    - return_segments_depart_airport_codes_array
    - onward_segments_hand_baggage_only_array
    - onward_segments_scheduled_arrivals_array
    - onward_segments_airline_codes_array
    - onward_segments_destination_cities_array
    - pricing__ancillary_charges__amount_breakup_array
    - pricing__preferred_currency
    - ixi_src_header
    - client_id
    - adjustments_amount_array
    - adjustments_display_text_array
    - adjustments_offer_id_array
    - adjustments_type_array
    - onward_ixigo_cancellation_ids_array
    - onward_cancellation_request_ids_array
    - return_ixi_booking_status_array
    - return_airline_pnrs_array
    - return_gds_pnrs_array
    - return_ticket_numbers_array
    - return_airline_ticket_numbers_array
    - gstin
    - refund_blocked
    - itinerary_create_response__ancillary_charges__ancillary_type__array
    - itinerary_create_response__ixi_markup
    - return_segments_count
    - trip_id
    - user_id
    - itinerary_id
    - pnr_list
    - onward_segments_origins_array
    - onward_segments_destinations_array
    - return_segments_origins_array
    - return_segments_destinations_array
    - partition_column
    - adjustments_units_array
    - fare_type
    - fare_type_benefits_names_array
    - fare_type_benefits_values_array
    - original_fare
    - child_trip_id
    - refunded
    - status_history_timestamps
    - payment_detail_requests__payment_amounts_array
    - pax_pricing__booking__onward_cancellation_request_ids_array
    - pax_pricing__booking__onward_ixigo_cancellation_ids_array
    - pax_pricing__booking__onward_pax_statuses__flight_booking_status_array
    - pax_pricing__booking__onward_pax_statuses__time_array
    - pax_pricing__booking__onward_pax_statuses__updated_by_array
    - pax_pricing__booking__onward_airline_pnr_history_array
    - pax_pricing__booking__onward_cabin_type_array
    - pax_pricing__booking__onward_ticket_type_array
    - pax_pricing__booking__onward_booking_status_array
    - pax_pricing__booking__onward_ixi_booking_status_array
    - pax_pricing__booking__onward_airline_pnrs_array
    - pax_pricing__fare_keys_array
    - pax_date_of_birth_array
    - return_segments_arrive_airports_array
    - onward_segments_airline_names_array
    - fare_type_benefits_costs_array
    - onward_airline_ticket_numbers_array
    - parent_trip_id
    - return_ixigo_cancellation_ids_array
    - return_cancellation_request_ids_array
    - adjustments_adjustment_id_array
    - total_order_amount
    - fare_type_details__fare_type_benefits__names_array
    - gst_detail__gstin
    - ancilliary_data__airports__code_array
    - pax_pricing__booking__return_ticket_type_array
    - pax_count
    - pricing__refundable
    - reschedule_sub_type
    - total_burn_amount
  - table_name: Ixigo Clickhouse.flight_search
    columns_to_ignore:
    - search_primary_id
    - product
    - cabin_class
    - timestamp
    - wallet_balance
    - num_of_adult
    - destination_code
    - destination_country
    - ip
    - os_version
    - device_os
    - client_id
    - app_version
    - origin_city
    - origin_code
    - user_id
    - uuid
    - ad_id
    - finger_print
    - device_id
    - latitude
    - longitude
    - arrival_date
    - provider_ids
    - ingestion_time
    - partition_column
    - num_of_children
    - num_of_infants
    - origin_state
    - origin_country
    - destination_city
    - destination_state
  behaviour: "Step1: Calculate the bucket wise APD_search with two columns APD_bucket\
    \ and APD_search_counts\nStep2: Calculate the bucket wise APD_transactions with\
    \ two columns APD_bucket and APD_transactions_counts\nStep3: For each bucket calculate\
    \ the conversion rate using the formula APD_transaction_counts divided by APD_search_counts.\
    \ Use left join to join the two tables from Step 1 and Step 2 with APD_bucket\
    \ as the common column. \n\nAPD_search = (timestamp_datetime - departure_date)\
    \ in days calculated from the 'flight_search' table.\nAPD_transactions = (created_at\
    \ - arrayElement(onwards_segments_scheduled_departures_array,1)) in days from\
    \ the 'fdwh_flight_booking_snapshot'\nUse DATEDIFF function to calculate the difference.\
    \ \nThe timestamp_datetime, departure_date, created_at, arrayElement(onwards_segments_scheduled_departures_array,1)\
    \ columns are in GMT. Convert all these columns to 'Asia/Kolkata' timezone before\
    \ generating any result. \nReturn APD counts for the following buckets: 0-2 days,\
    \ 3 - 7 days, 8 - 15 days, 16 - 30 days, 31 - 60 days, 61 - 90 days, 90 + days.\
    \  "
- keywords:
  - domestic bookings
  - domestic booking
  - domestic flight bookings
  - domestic flight booking
  table_config:
  - table_name: Ixigo Clickhouse.fdwh_flight_booking_snapshot
    columns_to_ignore:
    - changed_fare
    - fare_basis_codes_array
    - onward_ixi_booking_status_array
    - onward_airline_pnrs_array
    - onward_gds_pnrs_array
    - onward_ticket_numbers_array
    - payment_gateway_amount
    - collected_payment_gateway_amount
    - payment_transaction_ids_array
    - payment_amounts_array
    - payment_ids_array
    - fees
    - convenience_fee
    - burn_amount
    - discount
    - instant_discount
    - refundable
    - ancillary_amount_array
    - ancillary_provider_array
    - ancillary_type_array
    - currency
    - preferred_currency
    - base_fare
    - free_reschedule_transaction_ids
    - availing_free_reschedule
    - ingestion_time
    - offset
    - cabin_class
    - fare_key
    - inventory_type
    - flow_type_enum
    - insurance_provider
    - insurance_token
    - reschedule_trip_ids
    - flex_child_booking
    - reschedule_tracker_id
    - fare_type_details__fare_type_benefits__versions_array
    - fare_type_details__fare_type_benefits__refundable_array
    - fare_type_details__fare_type_benefits__benefit_provider_names_array
    - source
    - booking_type
    - adjustments__type_array
    - adjustments__units_array
    - partner_user_id
    - fare_type_details__fare_type_benefits__values_array
    - fare_type_details__fare_type_benefits__costs_array
    - invoice_url
    - invoice_id
    - updated_at
    - adjustments__adjustment_id_array
    - adjustments__amount_array
    - adjustments__display_text_array
    - adjustments__offer_id_array
    - availing_free_cancellation
    - native_cancellation
    - allow_reschedule
    - allow_cancellation
    - eticket_url
    - billing_address__city
    - billing_address__state
    - billing_address__pincode
    - billing_address__country
    - app_version
    - payment_transaction_id
    - free_cancellation_transaction_ids
    - gst_detail__phone_sha256
    - gst_detail__email
    - gst_detail__email_lower_sha256
    - gst_detail__updated_on
    - billing_address__address1
    - billing_address__address2
    - gst_detail__name
    - gst_detail__address
    - gst_detail__pin
    - gst_detail__state
    - gst_detail__phone
    - gst_detail__phone_sha1
    - instant_discount_applied
    - device_id
    - status_history_values
    - gst_detail__id
    - provider_booking_data__fare_details
    - provider_booking_data__cancellation_details
    - provider_booking_data__all_provider_fares
    - price_change_absorbed
    - coupon_code
    - itinerary_create_response__payment_response__gateway
    - international_for_ota
    - coupon_generated
    - user_source
    - provider_booking_data__search_id
    - itinerary_create_response__coupon_applied_msg
    - itinerary_create_response__convenience_fee
    - itinerary_create_response__ixigo_convenience_fee
    - itinerary_create_response__base_fare
    - itinerary_create_response__taxes
    - itinerary_create_response__total_burn_amount
    - itinerary_create_response__order_id
    - itinerary_create_response__payment_channel
    - itinerary_create_response__payment_type
    - itinerary_create_response__pg_type
    - itinerary_create_response__instant_discount
    - itinerary_create_response__cash_back_amount
    - itinerary_create_response__fare_change_message
    - ancilliary_data__airports__city_array
    - ancilliary_data__airports__country_array
    - itinerary_create_response__trip_id
    - itinerary_create_response__status_code
    - itinerary_create_response__current_fare
    - itinerary_create_response__changed_fare
    - itinerary_create_response__burn_amount
    - fare_rules_titles_array
    - fare_rules_texts_array
    - ancilliary_data__airlines__airline_code_array
    - payment_detail_requests__payment_transaction_ids_array
    - payment_detail_requests__transaction_ids_array
    - payment_detail_requests__offer_ids_array
    - payment_detail_requests__capture_statuses_array
    - payment_detail_request__payment_status
    - payment_detail_request__payment_transaction_id
    - payment_detail_request__transaction_id
    - payment_detail_request__offer_id
    - payment_detail_request__capture_status
    - payment_detail_request__payment_gateway_status
    - payment_detail_requests__payment_types_array
    - contact_detail__email__lower_sha1
    - contact_detail__email__lower_sha256
    - contact_detail__mobile
    - contact_detail__mobile_sha1
    - contact_detail__mobile_sha256
    - payment_detail_request__payment_type
    - payment_detail_request__payment_amount
    - pax_pricing__booking__return_pax_statuses__updated_by_array
    - pax_pricing__booking__return_airline_pnr_history_array
    - pax_pricing__booking__return_reschedule_trip_id_array
    - contact_detail__title
    - contact_detail__first_name
    - contact_detail__last_name
    - contact_detail__email
    - pax_pricing__booking__return_gds_pnrs_array
    - pax_pricing__booking__return_ticket_numbers_array
    - pax_pricing__booking__return_airline_ticket_numbers_array
    - pax_pricing__booking__return_cancellation_request_ids_array
    - pax_pricing__booking__return_ixigo_cancellation_ids_array
    - pax_pricing__booking__return_pax_statuses__flight_booking_status_array
    - pax_pricing__booking__return_pax_statuses__time_array
    - pax_pricing__booking__onward_reschedule_trip_id_array
    - pax_pricing__booking__return_booking_class_array
    - pax_pricing__booking__return_booking_status_array
    - pax_pricing__booking__return_ixi_booking_status_array
    - pax_pricing__booking__return_airline_pnrs_array
    - pax_pricing__booking__onward_gds_pnrs_array
    - pax_pricing__booking__onward_ticket_numbers_array
    - pax_pricing__fare_basis_codes_array
    - pax_pricing__fare_types_array
    - pax_pricing__pricing_elements_array
    - pax_pricing__booking_info_ids_array
    - pax_pricing__ixigo_forward_ids_array
    - pax_nationalities_array
    - pax_birth_country_array
    - pax_visa_type_array
    - pax_frequent_flier_number__airlines_array
    - pax_frequent_flier_number__number_array
    - pax_frequent_flier_number__applicable_airlines_array
    - pax_person_id_array
    - pax_id_number_array
    - pax_passport_number_array
    - pax_passport_issue_date_array
    - pax_passport_expiry_date_array
    - pax_passport_issuing_country_array
    - pax_indexes_array
    - pax_titles_array
    - pax_first_names_array
    - pax_last_names_array
    - pax_types_array
    - search_request__num_children
    - search_request__num_infants
    - search_request__origin
    - search_request__destination
    - search_request__is_international
    - return_segments_segment_pnrs_array
    - return_segments_durations_array
    - return_segments_checkin_luggage_array
    - return_segments_hand_luggage_array
    - return_segments_extra_charges_per_kg_array
    - return_segments_baggage_urls_array
    - return_segments_hand_baggage_only_array
    - return_segments_departure_terminals_array
    - return_segments_arrival_terminals_array
    - return_segments_booking_statuses_array
    - return_segments_booking_classes_array
    - return_segments_checkin_urls_array
    - return_segments_stops_array
    - return_segments_via_array
    - return_segments_scheduled_arrivals_array
    - return_segments_revised_scheduled_departures_array
    - return_segments_revised_scheduled_arrivals_array
    - return_segments_estimated_departures_array
    - return_segments_estimated_arrivals_array
    - return_segments_flight_status_codes_array
    - return_segments_internal_flight_status_codes_array
    - return_segments_arrive_timezones_array
    - return_segments_depart_airports_array
    - return_segments_arrive_airport_codes_array
    - return_segments_flight_numbers_array
    - return_segments_scheduled_departures_array
    - return_segments_airline_codes_array
    - return_segments_airline_names_array
    - return_segments_origin_cities_array
    - return_segments_destination_cities_array
    - return_segments_depart_timezones_array
    - onward_segments_via_array
    - onward_segments_segment_pnrs_array
    - onward_segments_durations_array
    - onward_segments_checkin_luggage_array
    - onward_segments_hand_luggage_array
    - onward_segments_extra_charges_per_kg_array
    - onward_segments_baggage_urls_array
    - onward_segments_internal_flight_status_codes_array
    - onward_segments_departure_terminals_array
    - onward_segments_arrival_terminals_array
    - onward_segments_booking_statuses_array
    - onward_segments_booking_classes_array
    - onward_segments_checkin_urls_array
    - onward_segments_stops_array
    - onward_segments_revised_scheduled_departures_array
    - onward_segments_revised_scheduled_arrivals_array
    - onward_segments_estimated_departures_array
    - onward_segments_estimated_arrivals_array
    - onward_segments_flight_status_codes_array
    - onward_segments_depart_timezones_array
    - onward_segments_arrive_timezones_array
    - onward_segments_depart_airports_array
    - onward_segments_depart_airport_codes_array
    - onward_segments_arrive_airports_array
    - onward_segments_arrive_airport_codes_array
    - onward_segments_flight_numbers_array
    - cabin_type
    - segment_count
    - onward_segments_count
    - onward_segments_origin_cities_array
    - pricing__ancillary_charges__ancillary_type_array
    - pricing__ancillary_charges__amount_array
    - pricing__ancillary_charges__provider_array
    - pricing__pending_insurance_amount
    - pricing__reschedule_adjustment
    - pricing__burn_amount
    - pricing__payment_gateway_amount
    - pricing__total_order_amount
    - pricing__collected_payment_gateway_amount
    - pricing__total_burn_amount
    - pricing__instant_discount
    - pricing__convenience_fee
    - pricing__refund_amount
    - pricing__ixi_money_refund
    - pricing__currency
    - pricing__fare_breakup__keys_array
    - pricing__fare_breakup__values__amounts_array
    - pricing__fare_breakup__values__ranks_array
    - pricing__base_fare
    - pricing__markup
    - pricing__ixi_markup
    - pricing__discount
    - fare_type_details__fare_type
    - gst_detail__email_lower_sha1
    - gst_detail__city
    - gst_detail__user_id
    - provider_booking_data__rw_search_id
    - payment_detail_requests__reference_ids_array
    - pricing__fees
    - pricing__taxes
    - pricing__total_fare
    - round_trip
    - onward_pnr
    - return_pnr
    - partner_booking_id_array
    - offered_fare
    - published_fare
    - extra_publish_fare_scraper
    - booking_status
    - search_primary_id
    - origin
    - destination
    - onward_departure_date
    - return_departure_date
    - provider_id
    - ancilliary_data__airlines__airline_name_array
    - ancilliary_data__airports__name_array
    - payment_detail_requests__payment_statuses_array
    - payment_detail_requests__payment_gateway_statuses_array
    - pax_pricing__booking__return_cabin_type_array
    - pax_pricing__booking__onward_airline_ticket_numbers_array
    - pax_pricing__booking__onward_booking_class_array
    - pax_pricing__pax_type_array
    - search_request__search_id
    - search_request__fare_key
    - search_request__num_adults
    - return_segments_depart_airport_codes_array
    - onward_segments_hand_baggage_only_array
    - onward_segments_scheduled_departures_array
    - onward_segments_scheduled_arrivals_array
    - onward_segments_airline_codes_array
    - onward_segments_destination_cities_array
    - pricing__ancillary_charges__amount_breakup_array
    - pricing__preferred_currency
    - ixi_src_header
    - client_id
    - adjustments_amount_array
    - adjustments_display_text_array
    - adjustments_offer_id_array
    - adjustments_type_array
    - onward_ixigo_cancellation_ids_array
    - onward_cancellation_request_ids_array
    - return_ixi_booking_status_array
    - return_airline_pnrs_array
    - return_gds_pnrs_array
    - return_ticket_numbers_array
    - return_airline_ticket_numbers_array
    - gstin
    - refund_blocked
    - itinerary_create_response__ancillary_charges__ancillary_type__array
    - itinerary_create_response__ixi_markup
    - return_segments_count
    - trip_id
    - user_id
    - itinerary_id
    - pnr_list
    - onward_segments_origins_array
    - onward_segments_destinations_array
    - return_segments_origins_array
    - return_segments_destinations_array
    - partition_column
    - adjustments_units_array
    - fare_type
    - fare_type_benefits_names_array
    - fare_type_benefits_values_array
    - original_fare
    - child_trip_id
    - refunded
    - status_history_timestamps
    - payment_detail_requests__payment_amounts_array
    - pax_pricing__booking__onward_cancellation_request_ids_array
    - pax_pricing__booking__onward_ixigo_cancellation_ids_array
    - pax_pricing__booking__onward_pax_statuses__flight_booking_status_array
    - pax_pricing__booking__onward_pax_statuses__time_array
    - pax_pricing__booking__onward_pax_statuses__updated_by_array
    - pax_pricing__booking__onward_airline_pnr_history_array
    - pax_pricing__booking__onward_cabin_type_array
    - pax_pricing__booking__onward_ticket_type_array
    - pax_pricing__booking__onward_booking_status_array
    - pax_pricing__booking__onward_ixi_booking_status_array
    - pax_pricing__booking__onward_airline_pnrs_array
    - pax_pricing__fare_keys_array
    - pax_date_of_birth_array
    - return_segments_arrive_airports_array
    - onward_segments_airline_names_array
    - fare_type_benefits_costs_array
    - onward_airline_ticket_numbers_array
    - parent_trip_id
    - return_ixigo_cancellation_ids_array
    - return_cancellation_request_ids_array
    - adjustments_adjustment_id_array
    - total_order_amount
    - fare_type_details__fare_type_benefits__names_array
    - gst_detail__gstin
    - ancilliary_data__airports__code_array
    - pax_pricing__booking__return_ticket_type_array
    - pax_count
    - pricing__refundable
    - reschedule_sub_type
    - total_burn_amount
  behaviour: ''
- keywords:
  - flex
  table_config:
  - table_name: Ixigo Clickhouse.fdwh_flight_booking_snapshot
    columns_to_ignore:
    - fare_basis_codes_array
    - onward_ixi_booking_status_array
    - onward_airline_pnrs_array
    - onward_gds_pnrs_array
    - onward_ticket_numbers_array
    - payment_gateway_amount
    - collected_payment_gateway_amount
    - payment_transaction_ids_array
    - payment_amounts_array
    - payment_ids_array
    - instant_discount
    - refundable
    - ancillary_amount_array
    - ancillary_provider_array
    - ancillary_type_array
    - currency
    - preferred_currency
    - base_fare
    - free_reschedule_transaction_ids
    - availing_free_reschedule
    - ingestion_time
    - offset
    - cabin_class
    - fare_key
    - inventory_type
    - flow_type_enum
    - insurance_provider
    - insurance_token
    - reschedule_trip_ids
    - flex_child_booking
    - reschedule_tracker_id
    - fare_type_details__fare_type_benefits__versions_array
    - fare_type_details__fare_type_benefits__refundable_array
    - fare_type_details__fare_type_benefits__benefit_provider_names_array
    - source
    - booking_type
    - adjustments__type_array
    - adjustments__units_array
    - partner_user_id
    - fare_type_details__fare_type_benefits__values_array
    - fare_type_details__fare_type_benefits__costs_array
    - invoice_url
    - invoice_id
    - updated_at
    - adjustments__adjustment_id_array
    - adjustments__amount_array
    - adjustments__display_text_array
    - adjustments__offer_id_array
    - availing_free_cancellation
    - native_cancellation
    - allow_reschedule
    - allow_cancellation
    - eticket_url
    - billing_address__city
    - billing_address__state
    - billing_address__pincode
    - billing_address__country
    - app_version
    - payment_transaction_id
    - free_cancellation_transaction_ids
    - gst_detail__phone_sha256
    - gst_detail__email
    - gst_detail__email_lower_sha256
    - gst_detail__updated_on
    - billing_address__address1
    - billing_address__address2
    - gst_detail__name
    - gst_detail__address
    - gst_detail__pin
    - gst_detail__state
    - gst_detail__phone
    - gst_detail__phone_sha1
    - instant_discount_applied
    - device_id
    - status_history_values
    - gst_detail__id
    - provider_booking_data__fare_details
    - provider_booking_data__cancellation_details
    - provider_booking_data__all_provider_fares
    - price_change_absorbed
    - order_id
    - coupon_code
    - itinerary_create_response__payment_response__gateway
    - international
    - international_for_ota
    - coupon_generated
    - user_source
    - provider_booking_data__search_id
    - itinerary_create_response__coupon_applied_msg
    - itinerary_create_response__convenience_fee
    - itinerary_create_response__ixigo_convenience_fee
    - itinerary_create_response__base_fare
    - itinerary_create_response__taxes
    - itinerary_create_response__total_burn_amount
    - itinerary_create_response__order_id
    - itinerary_create_response__payment_channel
    - itinerary_create_response__payment_type
    - itinerary_create_response__pg_type
    - itinerary_create_response__instant_discount
    - itinerary_create_response__cash_back_amount
    - itinerary_create_response__fare_change_message
    - ancilliary_data__airports__city_array
    - ancilliary_data__airports__country_array
    - itinerary_create_response__trip_id
    - itinerary_create_response__status_code
    - itinerary_create_response__current_fare
    - itinerary_create_response__changed_fare
    - itinerary_create_response__burn_amount
    - fare_rules_titles_array
    - fare_rules_texts_array
    - ancilliary_data__airlines__airline_code_array
    - payment_detail_requests__payment_transaction_ids_array
    - payment_detail_requests__transaction_ids_array
    - payment_detail_requests__offer_ids_array
    - payment_detail_requests__capture_statuses_array
    - payment_detail_request__payment_status
    - payment_detail_request__payment_transaction_id
    - payment_detail_request__transaction_id
    - payment_detail_request__offer_id
    - payment_detail_request__capture_status
    - payment_detail_request__payment_gateway_status
    - payment_detail_requests__payment_types_array
    - contact_detail__email__lower_sha1
    - contact_detail__email__lower_sha256
    - contact_detail__mobile
    - contact_detail__mobile_sha1
    - contact_detail__mobile_sha256
    - payment_detail_request__payment_type
    - payment_detail_request__payment_amount
    - pax_pricing__booking__return_pax_statuses__updated_by_array
    - pax_pricing__booking__return_airline_pnr_history_array
    - pax_pricing__booking__return_reschedule_trip_id_array
    - contact_detail__title
    - contact_detail__first_name
    - contact_detail__last_name
    - contact_detail__email
    - pax_pricing__booking__return_gds_pnrs_array
    - pax_pricing__booking__return_ticket_numbers_array
    - pax_pricing__booking__return_airline_ticket_numbers_array
    - pax_pricing__booking__return_cancellation_request_ids_array
    - pax_pricing__booking__return_ixigo_cancellation_ids_array
    - pax_pricing__booking__return_pax_statuses__flight_booking_status_array
    - pax_pricing__booking__return_pax_statuses__time_array
    - pax_pricing__booking__onward_reschedule_trip_id_array
    - pax_pricing__booking__return_booking_class_array
    - pax_pricing__booking__return_booking_status_array
    - pax_pricing__booking__return_ixi_booking_status_array
    - pax_pricing__booking__return_airline_pnrs_array
    - pax_pricing__booking__onward_gds_pnrs_array
    - pax_pricing__booking__onward_ticket_numbers_array
    - pax_pricing__fare_basis_codes_array
    - pax_pricing__fare_types_array
    - pax_pricing__pricing_elements_array
    - pax_pricing__booking_info_ids_array
    - pax_pricing__ixigo_forward_ids_array
    - pax_nationalities_array
    - pax_birth_country_array
    - pax_visa_type_array
    - pax_frequent_flier_number__airlines_array
    - pax_frequent_flier_number__number_array
    - pax_frequent_flier_number__applicable_airlines_array
    - pax_person_id_array
    - pax_id_number_array
    - pax_passport_number_array
    - pax_passport_issue_date_array
    - pax_passport_expiry_date_array
    - pax_passport_issuing_country_array
    - pax_indexes_array
    - pax_titles_array
    - pax_first_names_array
    - pax_last_names_array
    - pax_types_array
    - search_request__num_children
    - search_request__num_infants
    - search_request__origin
    - search_request__destination
    - search_request__is_international
    - return_segments_segment_pnrs_array
    - return_segments_durations_array
    - return_segments_checkin_luggage_array
    - return_segments_hand_luggage_array
    - return_segments_extra_charges_per_kg_array
    - return_segments_baggage_urls_array
    - return_segments_hand_baggage_only_array
    - return_segments_departure_terminals_array
    - return_segments_arrival_terminals_array
    - return_segments_booking_statuses_array
    - return_segments_booking_classes_array
    - return_segments_checkin_urls_array
    - return_segments_stops_array
    - return_segments_via_array
    - return_segments_scheduled_arrivals_array
    - return_segments_revised_scheduled_departures_array
    - return_segments_revised_scheduled_arrivals_array
    - return_segments_estimated_departures_array
    - return_segments_estimated_arrivals_array
    - return_segments_flight_status_codes_array
    - return_segments_internal_flight_status_codes_array
    - return_segments_arrive_timezones_array
    - return_segments_depart_airports_array
    - return_segments_arrive_airport_codes_array
    - return_segments_flight_numbers_array
    - return_segments_scheduled_departures_array
    - return_segments_airline_codes_array
    - return_segments_airline_names_array
    - return_segments_origin_cities_array
    - return_segments_destination_cities_array
    - return_segments_depart_timezones_array
    - onward_segments_via_array
    - onward_segments_segment_pnrs_array
    - onward_segments_durations_array
    - onward_segments_checkin_luggage_array
    - onward_segments_hand_luggage_array
    - onward_segments_extra_charges_per_kg_array
    - onward_segments_baggage_urls_array
    - onward_segments_internal_flight_status_codes_array
    - onward_segments_departure_terminals_array
    - onward_segments_arrival_terminals_array
    - onward_segments_booking_statuses_array
    - onward_segments_booking_classes_array
    - onward_segments_checkin_urls_array
    - onward_segments_stops_array
    - onward_segments_revised_scheduled_departures_array
    - onward_segments_revised_scheduled_arrivals_array
    - onward_segments_estimated_departures_array
    - onward_segments_estimated_arrivals_array
    - onward_segments_flight_status_codes_array
    - onward_segments_depart_timezones_array
    - onward_segments_arrive_timezones_array
    - onward_segments_depart_airports_array
    - onward_segments_depart_airport_codes_array
    - onward_segments_arrive_airports_array
    - onward_segments_arrive_airport_codes_array
    - onward_segments_flight_numbers_array
    - cabin_type
    - segment_count
    - onward_segments_count
    - onward_segments_origin_cities_array
    - pricing__ancillary_charges__ancillary_type_array
    - pricing__ancillary_charges__amount_array
    - pricing__ancillary_charges__provider_array
    - pricing__pending_insurance_amount
    - pricing__reschedule_adjustment
    - pricing__burn_amount
    - pricing__payment_gateway_amount
    - pricing__total_order_amount
    - pricing__collected_payment_gateway_amount
    - pricing__total_burn_amount
    - pricing__instant_discount
    - pricing__convenience_fee
    - pricing__refund_amount
    - pricing__ixi_money_refund
    - pricing__currency
    - pricing__fare_breakup__keys_array
    - pricing__fare_breakup__values__amounts_array
    - pricing__fare_breakup__values__ranks_array
    - pricing__base_fare
    - pricing__markup
    - pricing__ixi_markup
    - pricing__discount
    - gst_detail__email_lower_sha1
    - gst_detail__city
    - gst_detail__user_id
    - provider_booking_data__rw_search_id
    - payment_detail_requests__reference_ids_array
    - pricing__fees
    - pricing__taxes
    - pricing__total_fare
    - round_trip
    - onward_pnr
    - return_pnr
    - partner_booking_id_array
    - offered_fare
    - published_fare
    - extra_publish_fare_scraper
    - booking_status
    - created_at
    - search_primary_id
    - origin
    - destination
    - onward_departure_date
    - return_departure_date
    - provider_id
    - ancilliary_data__airlines__airline_name_array
    - ancilliary_data__airports__name_array
    - payment_detail_requests__payment_statuses_array
    - payment_detail_requests__payment_gateway_statuses_array
    - pax_pricing__booking__return_cabin_type_array
    - pax_pricing__booking__onward_airline_ticket_numbers_array
    - pax_pricing__booking__onward_booking_class_array
    - pax_pricing__pax_type_array
    - search_request__search_id
    - search_request__fare_key
    - search_request__num_adults
    - return_segments_depart_airport_codes_array
    - onward_segments_hand_baggage_only_array
    - onward_segments_scheduled_departures_array
    - onward_segments_scheduled_arrivals_array
    - onward_segments_airline_codes_array
    - onward_segments_destination_cities_array
    - pricing__ancillary_charges__amount_breakup_array
    - pricing__preferred_currency
    - ixi_src_header
    - client_id
    - adjustments_amount_array
    - adjustments_display_text_array
    - adjustments_offer_id_array
    - adjustments_type_array
    - onward_ixigo_cancellation_ids_array
    - onward_cancellation_request_ids_array
    - return_ixi_booking_status_array
    - return_airline_pnrs_array
    - return_gds_pnrs_array
    - return_ticket_numbers_array
    - return_airline_ticket_numbers_array
    - gstin
    - refund_blocked
    - itinerary_create_response__ancillary_charges__ancillary_type__array
    - itinerary_create_response__ixi_markup
    - return_segments_count
    - trip_id
    - user_id
    - itinerary_id
    - pnr_list
    - onward_segments_origins_array
    - onward_segments_destinations_array
    - return_segments_origins_array
    - return_segments_destinations_array
    - partition_column
    - adjustments_units_array
    - fare_type
    - fare_type_benefits_names_array
    - fare_type_benefits_values_array
    - original_fare
    - child_trip_id
    - refunded
    - status_history_timestamps
    - payment_detail_requests__payment_amounts_array
    - pax_pricing__booking__onward_cancellation_request_ids_array
    - pax_pricing__booking__onward_ixigo_cancellation_ids_array
    - pax_pricing__booking__onward_pax_statuses__flight_booking_status_array
    - pax_pricing__booking__onward_pax_statuses__time_array
    - pax_pricing__booking__onward_pax_statuses__updated_by_array
    - pax_pricing__booking__onward_airline_pnr_history_array
    - pax_pricing__booking__onward_cabin_type_array
    - pax_pricing__booking__onward_ticket_type_array
    - pax_pricing__booking__onward_booking_status_array
    - pax_pricing__booking__onward_ixi_booking_status_array
    - pax_pricing__booking__onward_airline_pnrs_array
    - pax_pricing__fare_keys_array
    - pax_date_of_birth_array
    - return_segments_arrive_airports_array
    - onward_segments_airline_names_array
    - fare_type_benefits_costs_array
    - onward_airline_ticket_numbers_array
    - parent_trip_id
    - return_ixigo_cancellation_ids_array
    - return_cancellation_request_ids_array
    - adjustments_adjustment_id_array
    - total_order_amount
    - fare_type_details__fare_type_benefits__names_array
    - gst_detail__gstin
    - ancilliary_data__airports__code_array
    - pax_pricing__booking__return_ticket_type_array
    - pricing__refundable
    - reschedule_sub_type
    - total_burn_amount
  behaviour: use "fare_type_details__fare_type" = 'FLEX' to get the bookings with
    flex
- keywords:
  - Pax Wise ATV
  table_config:
  - table_name: Ixigo Clickhouse.fdwh_flight_booking_snapshot
    columns_to_ignore:
    - changed_fare
    - fare_basis_codes_array
    - onward_ixi_booking_status_array
    - onward_airline_pnrs_array
    - onward_gds_pnrs_array
    - onward_ticket_numbers_array
    - payment_gateway_amount
    - collected_payment_gateway_amount
    - payment_transaction_ids_array
    - payment_amounts_array
    - payment_ids_array
    - burn_amount
    - discount
    - instant_discount
    - refundable
    - ancillary_amount_array
    - ancillary_provider_array
    - ancillary_type_array
    - currency
    - preferred_currency
    - base_fare
    - free_reschedule_transaction_ids
    - availing_free_reschedule
    - ingestion_time
    - offset
    - cabin_class
    - fare_key
    - inventory_type
    - flow_type_enum
    - insurance_provider
    - insurance_token
    - reschedule_trip_ids
    - flex_child_booking
    - reschedule_tracker_id
    - fare_type_details__fare_type_benefits__versions_array
    - fare_type_details__fare_type_benefits__refundable_array
    - fare_type_details__fare_type_benefits__benefit_provider_names_array
    - source
    - booking_type
    - adjustments__type_array
    - adjustments__units_array
    - partner_user_id
    - fare_type_details__fare_type_benefits__values_array
    - fare_type_details__fare_type_benefits__costs_array
    - invoice_url
    - invoice_id
    - updated_at
    - adjustments__adjustment_id_array
    - adjustments__amount_array
    - adjustments__display_text_array
    - adjustments__offer_id_array
    - availing_free_cancellation
    - native_cancellation
    - allow_reschedule
    - allow_cancellation
    - eticket_url
    - billing_address__city
    - billing_address__state
    - billing_address__pincode
    - billing_address__country
    - app_version
    - payment_transaction_id
    - free_cancellation_transaction_ids
    - gst_detail__phone_sha256
    - gst_detail__email
    - gst_detail__email_lower_sha256
    - gst_detail__updated_on
    - billing_address__address1
    - billing_address__address2
    - gst_detail__name
    - gst_detail__address
    - gst_detail__pin
    - gst_detail__state
    - gst_detail__phone
    - gst_detail__phone_sha1
    - instant_discount_applied
    - device_id
    - status_history_values
    - gst_detail__id
    - provider_booking_data__fare_details
    - provider_booking_data__cancellation_details
    - provider_booking_data__all_provider_fares
    - price_change_absorbed
    - order_id
    - coupon_code
    - itinerary_create_response__payment_response__gateway
    - international
    - international_for_ota
    - coupon_generated
    - user_source
    - provider_booking_data__search_id
    - itinerary_create_response__coupon_applied_msg
    - itinerary_create_response__convenience_fee
    - itinerary_create_response__ixigo_convenience_fee
    - itinerary_create_response__base_fare
    - itinerary_create_response__taxes
    - itinerary_create_response__total_burn_amount
    - itinerary_create_response__order_id
    - itinerary_create_response__payment_channel
    - itinerary_create_response__payment_type
    - itinerary_create_response__pg_type
    - itinerary_create_response__instant_discount
    - itinerary_create_response__cash_back_amount
    - itinerary_create_response__fare_change_message
    - ancilliary_data__airports__city_array
    - ancilliary_data__airports__country_array
    - itinerary_create_response__trip_id
    - itinerary_create_response__status_code
    - itinerary_create_response__current_fare
    - itinerary_create_response__changed_fare
    - itinerary_create_response__burn_amount
    - fare_rules_titles_array
    - fare_rules_texts_array
    - ancilliary_data__airlines__airline_code_array
    - payment_detail_requests__payment_transaction_ids_array
    - payment_detail_requests__transaction_ids_array
    - payment_detail_requests__offer_ids_array
    - payment_detail_requests__capture_statuses_array
    - payment_detail_request__payment_status
    - payment_detail_request__payment_transaction_id
    - payment_detail_request__transaction_id
    - payment_detail_request__offer_id
    - payment_detail_request__capture_status
    - payment_detail_request__payment_gateway_status
    - payment_detail_requests__payment_types_array
    - contact_detail__email__lower_sha1
    - contact_detail__email__lower_sha256
    - contact_detail__mobile
    - contact_detail__mobile_sha1
    - contact_detail__mobile_sha256
    - payment_detail_request__payment_type
    - payment_detail_request__payment_amount
    - pax_pricing__booking__return_pax_statuses__updated_by_array
    - pax_pricing__booking__return_airline_pnr_history_array
    - pax_pricing__booking__return_reschedule_trip_id_array
    - contact_detail__title
    - contact_detail__first_name
    - contact_detail__last_name
    - contact_detail__email
    - pax_pricing__booking__return_gds_pnrs_array
    - pax_pricing__booking__return_ticket_numbers_array
    - pax_pricing__booking__return_airline_ticket_numbers_array
    - pax_pricing__booking__return_cancellation_request_ids_array
    - pax_pricing__booking__return_ixigo_cancellation_ids_array
    - pax_pricing__booking__return_pax_statuses__flight_booking_status_array
    - pax_pricing__booking__return_pax_statuses__time_array
    - pax_pricing__booking__onward_reschedule_trip_id_array
    - pax_pricing__booking__return_booking_class_array
    - pax_pricing__booking__return_booking_status_array
    - pax_pricing__booking__return_ixi_booking_status_array
    - pax_pricing__booking__return_airline_pnrs_array
    - pax_pricing__booking__onward_gds_pnrs_array
    - pax_pricing__booking__onward_ticket_numbers_array
    - pax_pricing__fare_basis_codes_array
    - pax_pricing__fare_types_array
    - pax_pricing__pricing_elements_array
    - pax_pricing__booking_info_ids_array
    - pax_pricing__ixigo_forward_ids_array
    - pax_nationalities_array
    - pax_birth_country_array
    - pax_visa_type_array
    - pax_frequent_flier_number__airlines_array
    - pax_frequent_flier_number__number_array
    - pax_frequent_flier_number__applicable_airlines_array
    - pax_person_id_array
    - pax_id_number_array
    - pax_passport_number_array
    - pax_passport_issue_date_array
    - pax_passport_expiry_date_array
    - pax_passport_issuing_country_array
    - pax_indexes_array
    - pax_titles_array
    - pax_first_names_array
    - pax_last_names_array
    - pax_types_array
    - search_request__num_children
    - search_request__num_infants
    - search_request__origin
    - search_request__destination
    - search_request__is_international
    - return_segments_segment_pnrs_array
    - return_segments_durations_array
    - return_segments_checkin_luggage_array
    - return_segments_hand_luggage_array
    - return_segments_extra_charges_per_kg_array
    - return_segments_baggage_urls_array
    - return_segments_hand_baggage_only_array
    - return_segments_departure_terminals_array
    - return_segments_arrival_terminals_array
    - return_segments_booking_statuses_array
    - return_segments_booking_classes_array
    - return_segments_checkin_urls_array
    - return_segments_stops_array
    - return_segments_via_array
    - return_segments_scheduled_arrivals_array
    - return_segments_revised_scheduled_departures_array
    - return_segments_revised_scheduled_arrivals_array
    - return_segments_estimated_departures_array
    - return_segments_estimated_arrivals_array
    - return_segments_flight_status_codes_array
    - return_segments_internal_flight_status_codes_array
    - return_segments_arrive_timezones_array
    - return_segments_depart_airports_array
    - return_segments_arrive_airport_codes_array
    - return_segments_flight_numbers_array
    - return_segments_scheduled_departures_array
    - return_segments_airline_codes_array
    - return_segments_airline_names_array
    - return_segments_origin_cities_array
    - return_segments_destination_cities_array
    - return_segments_depart_timezones_array
    - onward_segments_via_array
    - onward_segments_segment_pnrs_array
    - onward_segments_durations_array
    - onward_segments_checkin_luggage_array
    - onward_segments_hand_luggage_array
    - onward_segments_extra_charges_per_kg_array
    - onward_segments_baggage_urls_array
    - onward_segments_internal_flight_status_codes_array
    - onward_segments_departure_terminals_array
    - onward_segments_arrival_terminals_array
    - onward_segments_booking_statuses_array
    - onward_segments_booking_classes_array
    - onward_segments_checkin_urls_array
    - onward_segments_stops_array
    - onward_segments_revised_scheduled_departures_array
    - onward_segments_revised_scheduled_arrivals_array
    - onward_segments_estimated_departures_array
    - onward_segments_estimated_arrivals_array
    - onward_segments_flight_status_codes_array
    - onward_segments_depart_timezones_array
    - onward_segments_arrive_timezones_array
    - onward_segments_depart_airports_array
    - onward_segments_depart_airport_codes_array
    - onward_segments_arrive_airports_array
    - onward_segments_arrive_airport_codes_array
    - onward_segments_flight_numbers_array
    - cabin_type
    - segment_count
    - onward_segments_count
    - onward_segments_origin_cities_array
    - pricing__ancillary_charges__ancillary_type_array
    - pricing__ancillary_charges__amount_array
    - pricing__ancillary_charges__provider_array
    - pricing__pending_insurance_amount
    - pricing__reschedule_adjustment
    - pricing__burn_amount
    - pricing__payment_gateway_amount
    - pricing__total_order_amount
    - pricing__collected_payment_gateway_amount
    - pricing__total_burn_amount
    - pricing__instant_discount
    - pricing__refund_amount
    - pricing__ixi_money_refund
    - pricing__currency
    - pricing__fare_breakup__keys_array
    - pricing__fare_breakup__values__amounts_array
    - pricing__fare_breakup__values__ranks_array
    - pricing__base_fare
    - pricing__markup
    - pricing__ixi_markup
    - pricing__discount
    - gst_detail__email_lower_sha1
    - gst_detail__city
    - gst_detail__user_id
    - provider_booking_data__rw_search_id
    - payment_detail_requests__reference_ids_array
    - round_trip
    - onward_pnr
    - return_pnr
    - partner_booking_id_array
    - offered_fare
    - published_fare
    - extra_publish_fare_scraper
    - booking_status
    - search_primary_id
    - origin
    - destination
    - onward_departure_date
    - return_departure_date
    - provider_id
    - ancilliary_data__airlines__airline_name_array
    - ancilliary_data__airports__name_array
    - payment_detail_requests__payment_statuses_array
    - payment_detail_requests__payment_gateway_statuses_array
    - pax_pricing__booking__return_cabin_type_array
    - pax_pricing__booking__onward_airline_ticket_numbers_array
    - pax_pricing__booking__onward_booking_class_array
    - pax_pricing__pax_type_array
    - search_request__search_id
    - search_request__fare_key
    - search_request__num_adults
    - return_segments_depart_airport_codes_array
    - onward_segments_hand_baggage_only_array
    - onward_segments_scheduled_departures_array
    - onward_segments_scheduled_arrivals_array
    - onward_segments_airline_codes_array
    - onward_segments_destination_cities_array
    - pricing__ancillary_charges__amount_breakup_array
    - pricing__preferred_currency
    - ixi_src_header
    - client_id
    - adjustments_amount_array
    - adjustments_display_text_array
    - adjustments_offer_id_array
    - adjustments_type_array
    - onward_ixigo_cancellation_ids_array
    - onward_cancellation_request_ids_array
    - return_ixi_booking_status_array
    - return_airline_pnrs_array
    - return_gds_pnrs_array
    - return_ticket_numbers_array
    - return_airline_ticket_numbers_array
    - gstin
    - refund_blocked
    - itinerary_create_response__ancillary_charges__ancillary_type__array
    - itinerary_create_response__ixi_markup
    - return_segments_count
    - trip_id
    - user_id
    - itinerary_id
    - pnr_list
    - onward_segments_origins_array
    - onward_segments_destinations_array
    - return_segments_origins_array
    - return_segments_destinations_array
    - partition_column
    - adjustments_units_array
    - fare_type
    - fare_type_benefits_names_array
    - fare_type_benefits_values_array
    - original_fare
    - child_trip_id
    - refunded
    - status_history_timestamps
    - payment_detail_requests__payment_amounts_array
    - pax_pricing__booking__onward_cancellation_request_ids_array
    - pax_pricing__booking__onward_ixigo_cancellation_ids_array
    - pax_pricing__booking__onward_pax_statuses__flight_booking_status_array
    - pax_pricing__booking__onward_pax_statuses__time_array
    - pax_pricing__booking__onward_pax_statuses__updated_by_array
    - pax_pricing__booking__onward_airline_pnr_history_array
    - pax_pricing__booking__onward_cabin_type_array
    - pax_pricing__booking__onward_ticket_type_array
    - pax_pricing__booking__onward_booking_status_array
    - pax_pricing__booking__onward_ixi_booking_status_array
    - pax_pricing__booking__onward_airline_pnrs_array
    - pax_pricing__fare_keys_array
    - pax_date_of_birth_array
    - return_segments_arrive_airports_array
    - onward_segments_airline_names_array
    - fare_type_benefits_costs_array
    - onward_airline_ticket_numbers_array
    - parent_trip_id
    - return_ixigo_cancellation_ids_array
    - return_cancellation_request_ids_array
    - adjustments_adjustment_id_array
    - total_order_amount
    - fare_type_details__fare_type_benefits__names_array
    - gst_detail__gstin
    - ancilliary_data__airports__code_array
    - pax_pricing__booking__return_ticket_type_array
    - pricing__refundable
    - reschedule_sub_type
    - total_burn_amount
  behaviour: Pax Wise ATV = sum(Total Fare - Convenience Fee)/ sum(pax_count)
- keywords:
  - Total Flex Fee Collected
  - Total premium collected
  - journey type
  table_config:
  - table_name: Ixigo Clickhouse.fdwh_freeCancellationPolicy_snapshot
    columns_to_ignore:
    - pax_title
    - policy_status
    - quotation_number
    - proposal_number
    - dcn_number
    - receipt_number
    - transaction_id
    - partition_column
    - premium_markup
    - coverage_amount
    - claimed_amount
    - offset
    - phone_number
    - pax_id
    - comments
    - policy_url
    - client_policy_url
    - user_id
    - policy_number
    - pax_lname
    - pax_lname___normalised
    - claim_window_hrs
    - ingestion_time
    - source_name
    - flag
    - master_policy_number
    - plan_group
    - policy_variant
    - cd_account_number
    - intermediary_code
    - pax_fname
    - pax_fname___normalised
    - plan_type
    - insurance_provider_name
    - provider_id
    - email
    - email___normalised
  - table_name: Ixigo Clickhouse.fdwh_flight_booking_snapshot
    columns_to_ignore:
    - changed_fare
    - fare_basis_codes_array
    - onward_ixi_booking_status_array
    - onward_airline_pnrs_array
    - onward_gds_pnrs_array
    - onward_ticket_numbers_array
    - payment_gateway_amount
    - collected_payment_gateway_amount
    - payment_transaction_ids_array
    - payment_amounts_array
    - payment_ids_array
    - taxes
    - total_fare
    - fees
    - convenience_fee
    - burn_amount
    - discount
    - instant_discount
    - refundable
    - ancillary_amount_array
    - ancillary_provider_array
    - ancillary_type_array
    - currency
    - preferred_currency
    - base_fare
    - free_reschedule_transaction_ids
    - availing_free_reschedule
    - ingestion_time
    - offset
    - cabin_class
    - fare_key
    - inventory_type
    - flow_type_enum
    - insurance_provider
    - insurance_token
    - reschedule_trip_ids
    - flex_child_booking
    - reschedule_tracker_id
    - fare_type_details__fare_type_benefits__versions_array
    - fare_type_details__fare_type_benefits__refundable_array
    - fare_type_details__fare_type_benefits__benefit_provider_names_array
    - source
    - booking_type
    - adjustments__type_array
    - adjustments__units_array
    - partner_user_id
    - fare_type_details__fare_type_benefits__values_array
    - fare_type_details__fare_type_benefits__costs_array
    - invoice_url
    - invoice_id
    - updated_at
    - adjustments__adjustment_id_array
    - adjustments__amount_array
    - adjustments__display_text_array
    - adjustments__offer_id_array
    - availing_free_cancellation
    - native_cancellation
    - allow_reschedule
    - allow_cancellation
    - eticket_url
    - billing_address__city
    - billing_address__state
    - billing_address__pincode
    - billing_address__country
    - app_version
    - payment_transaction_id
    - free_cancellation_transaction_ids
    - gst_detail__phone_sha256
    - gst_detail__email
    - gst_detail__email_lower_sha256
    - gst_detail__updated_on
    - billing_address__address1
    - billing_address__address2
    - gst_detail__name
    - gst_detail__address
    - gst_detail__pin
    - gst_detail__state
    - gst_detail__phone
    - gst_detail__phone_sha1
    - instant_discount_applied
    - device_id
    - status_history_values
    - gst_detail__id
    - provider_booking_data__fare_details
    - provider_booking_data__cancellation_details
    - provider_booking_data__all_provider_fares
    - price_change_absorbed
    - order_id
    - coupon_code
    - itinerary_create_response__payment_response__gateway
    - international
    - international_for_ota
    - coupon_generated
    - user_source
    - provider_booking_data__search_id
    - itinerary_create_response__coupon_applied_msg
    - itinerary_create_response__convenience_fee
    - itinerary_create_response__ixigo_convenience_fee
    - itinerary_create_response__base_fare
    - itinerary_create_response__taxes
    - itinerary_create_response__total_burn_amount
    - itinerary_create_response__order_id
    - itinerary_create_response__payment_channel
    - itinerary_create_response__payment_type
    - itinerary_create_response__pg_type
    - itinerary_create_response__instant_discount
    - itinerary_create_response__cash_back_amount
    - itinerary_create_response__fare_change_message
    - ancilliary_data__airports__city_array
    - ancilliary_data__airports__country_array
    - itinerary_create_response__trip_id
    - itinerary_create_response__status_code
    - itinerary_create_response__current_fare
    - itinerary_create_response__changed_fare
    - itinerary_create_response__burn_amount
    - fare_rules_titles_array
    - fare_rules_texts_array
    - ancilliary_data__airlines__airline_code_array
    - payment_detail_requests__payment_transaction_ids_array
    - payment_detail_requests__transaction_ids_array
    - payment_detail_requests__offer_ids_array
    - payment_detail_requests__capture_statuses_array
    - payment_detail_request__payment_status
    - payment_detail_request__payment_transaction_id
    - payment_detail_request__transaction_id
    - payment_detail_request__offer_id
    - payment_detail_request__capture_status
    - payment_detail_request__payment_gateway_status
    - payment_detail_requests__payment_types_array
    - contact_detail__email__lower_sha1
    - contact_detail__email__lower_sha256
    - contact_detail__mobile
    - contact_detail__mobile_sha1
    - contact_detail__mobile_sha256
    - payment_detail_request__payment_type
    - payment_detail_request__payment_amount
    - pax_pricing__booking__return_pax_statuses__updated_by_array
    - pax_pricing__booking__return_airline_pnr_history_array
    - pax_pricing__booking__return_reschedule_trip_id_array
    - contact_detail__title
    - contact_detail__first_name
    - contact_detail__last_name
    - contact_detail__email
    - pax_pricing__booking__return_gds_pnrs_array
    - pax_pricing__booking__return_ticket_numbers_array
    - pax_pricing__booking__return_airline_ticket_numbers_array
    - pax_pricing__booking__return_cancellation_request_ids_array
    - pax_pricing__booking__return_ixigo_cancellation_ids_array
    - pax_pricing__booking__return_pax_statuses__flight_booking_status_array
    - pax_pricing__booking__return_pax_statuses__time_array
    - pax_pricing__booking__onward_reschedule_trip_id_array
    - pax_pricing__booking__return_booking_class_array
    - pax_pricing__booking__return_booking_status_array
    - pax_pricing__booking__return_ixi_booking_status_array
    - pax_pricing__booking__return_airline_pnrs_array
    - pax_pricing__booking__onward_gds_pnrs_array
    - pax_pricing__booking__onward_ticket_numbers_array
    - pax_pricing__fare_basis_codes_array
    - pax_pricing__fare_types_array
    - pax_pricing__pricing_elements_array
    - pax_pricing__booking_info_ids_array
    - pax_pricing__ixigo_forward_ids_array
    - pax_nationalities_array
    - pax_birth_country_array
    - pax_visa_type_array
    - pax_frequent_flier_number__airlines_array
    - pax_frequent_flier_number__number_array
    - pax_frequent_flier_number__applicable_airlines_array
    - pax_person_id_array
    - pax_id_number_array
    - pax_passport_number_array
    - pax_passport_issue_date_array
    - pax_passport_expiry_date_array
    - pax_passport_issuing_country_array
    - pax_indexes_array
    - pax_titles_array
    - pax_first_names_array
    - pax_last_names_array
    - pax_types_array
    - search_request__num_children
    - search_request__num_infants
    - search_request__origin
    - search_request__destination
    - search_request__is_international
    - return_segments_segment_pnrs_array
    - return_segments_durations_array
    - return_segments_checkin_luggage_array
    - return_segments_hand_luggage_array
    - return_segments_extra_charges_per_kg_array
    - return_segments_baggage_urls_array
    - return_segments_hand_baggage_only_array
    - return_segments_departure_terminals_array
    - return_segments_arrival_terminals_array
    - return_segments_booking_statuses_array
    - return_segments_booking_classes_array
    - return_segments_checkin_urls_array
    - return_segments_stops_array
    - return_segments_via_array
    - return_segments_scheduled_arrivals_array
    - return_segments_revised_scheduled_departures_array
    - return_segments_revised_scheduled_arrivals_array
    - return_segments_estimated_departures_array
    - return_segments_estimated_arrivals_array
    - return_segments_flight_status_codes_array
    - return_segments_internal_flight_status_codes_array
    - return_segments_arrive_timezones_array
    - return_segments_depart_airports_array
    - return_segments_arrive_airport_codes_array
    - return_segments_flight_numbers_array
    - return_segments_scheduled_departures_array
    - return_segments_airline_codes_array
    - return_segments_airline_names_array
    - return_segments_origin_cities_array
    - return_segments_destination_cities_array
    - return_segments_depart_timezones_array
    - onward_segments_via_array
    - onward_segments_segment_pnrs_array
    - onward_segments_durations_array
    - onward_segments_checkin_luggage_array
    - onward_segments_hand_luggage_array
    - onward_segments_extra_charges_per_kg_array
    - onward_segments_baggage_urls_array
    - onward_segments_internal_flight_status_codes_array
    - onward_segments_departure_terminals_array
    - onward_segments_arrival_terminals_array
    - onward_segments_booking_statuses_array
    - onward_segments_booking_classes_array
    - onward_segments_checkin_urls_array
    - onward_segments_stops_array
    - onward_segments_revised_scheduled_departures_array
    - onward_segments_revised_scheduled_arrivals_array
    - onward_segments_estimated_departures_array
    - onward_segments_estimated_arrivals_array
    - onward_segments_flight_status_codes_array
    - onward_segments_depart_timezones_array
    - onward_segments_arrive_timezones_array
    - onward_segments_depart_airports_array
    - onward_segments_depart_airport_codes_array
    - onward_segments_arrive_airports_array
    - onward_segments_arrive_airport_codes_array
    - onward_segments_flight_numbers_array
    - cabin_type
    - segment_count
    - onward_segments_count
    - onward_segments_origin_cities_array
    - pricing__ancillary_charges__ancillary_type_array
    - pricing__ancillary_charges__amount_array
    - pricing__ancillary_charges__provider_array
    - pricing__pending_insurance_amount
    - pricing__reschedule_adjustment
    - pricing__burn_amount
    - pricing__payment_gateway_amount
    - pricing__total_order_amount
    - pricing__collected_payment_gateway_amount
    - pricing__total_burn_amount
    - pricing__instant_discount
    - pricing__convenience_fee
    - pricing__refund_amount
    - pricing__ixi_money_refund
    - pricing__currency
    - pricing__fare_breakup__keys_array
    - pricing__fare_breakup__values__amounts_array
    - pricing__fare_breakup__values__ranks_array
    - pricing__base_fare
    - pricing__markup
    - pricing__ixi_markup
    - pricing__discount
    - fare_type_details__fare_type
    - gst_detail__email_lower_sha1
    - gst_detail__city
    - gst_detail__user_id
    - provider_booking_data__rw_search_id
    - payment_detail_requests__reference_ids_array
    - round_trip
    - onward_pnr
    - return_pnr
    - partner_booking_id_array
    - offered_fare
    - published_fare
    - extra_publish_fare_scraper
    - booking_status
    - search_primary_id
    - onward_departure_date
    - return_departure_date
    - provider_id
    - ancilliary_data__airlines__airline_name_array
    - ancilliary_data__airports__name_array
    - payment_detail_requests__payment_statuses_array
    - payment_detail_requests__payment_gateway_statuses_array
    - pax_pricing__booking__return_cabin_type_array
    - pax_pricing__booking__onward_airline_ticket_numbers_array
    - pax_pricing__booking__onward_booking_class_array
    - pax_pricing__pax_type_array
    - search_request__search_id
    - search_request__fare_key
    - search_request__num_adults
    - return_segments_depart_airport_codes_array
    - onward_segments_hand_baggage_only_array
    - onward_segments_scheduled_departures_array
    - onward_segments_scheduled_arrivals_array
    - onward_segments_airline_codes_array
    - onward_segments_destination_cities_array
    - pricing__ancillary_charges__amount_breakup_array
    - pricing__preferred_currency
    - ixi_src_header
    - client_id
    - adjustments_amount_array
    - adjustments_display_text_array
    - adjustments_offer_id_array
    - adjustments_type_array
    - onward_ixigo_cancellation_ids_array
    - onward_cancellation_request_ids_array
    - return_ixi_booking_status_array
    - return_airline_pnrs_array
    - return_gds_pnrs_array
    - return_ticket_numbers_array
    - return_airline_ticket_numbers_array
    - gstin
    - refund_blocked
    - itinerary_create_response__ancillary_charges__ancillary_type__array
    - itinerary_create_response__ixi_markup
    - return_segments_count
    - trip_id
    - user_id
    - itinerary_id
    - pnr_list
    - onward_segments_origins_array
    - onward_segments_destinations_array
    - return_segments_origins_array
    - return_segments_destinations_array
    - partition_column
    - adjustments_units_array
    - fare_type
    - fare_type_benefits_names_array
    - fare_type_benefits_values_array
    - original_fare
    - child_trip_id
    - refunded
    - status_history_timestamps
    - payment_detail_requests__payment_amounts_array
    - pax_pricing__booking__onward_cancellation_request_ids_array
    - pax_pricing__booking__onward_ixigo_cancellation_ids_array
    - pax_pricing__booking__onward_pax_statuses__flight_booking_status_array
    - pax_pricing__booking__onward_pax_statuses__time_array
    - pax_pricing__booking__onward_pax_statuses__updated_by_array
    - pax_pricing__booking__onward_airline_pnr_history_array
    - pax_pricing__booking__onward_cabin_type_array
    - pax_pricing__booking__onward_ticket_type_array
    - pax_pricing__booking__onward_booking_status_array
    - pax_pricing__booking__onward_ixi_booking_status_array
    - pax_pricing__booking__onward_airline_pnrs_array
    - pax_pricing__fare_keys_array
    - pax_date_of_birth_array
    - return_segments_arrive_airports_array
    - onward_segments_airline_names_array
    - fare_type_benefits_costs_array
    - onward_airline_ticket_numbers_array
    - parent_trip_id
    - return_ixigo_cancellation_ids_array
    - return_cancellation_request_ids_array
    - adjustments_adjustment_id_array
    - fare_type_details__fare_type_benefits__names_array
    - gst_detail__gstin
    - ancilliary_data__airports__code_array
    - pax_pricing__booking__return_ticket_type_array
    - pax_count
    - pricing__refundable
    - reschedule_sub_type
    - total_burn_amount
  behaviour: Total Flex Fee Collected=Total premium collected-Tax
